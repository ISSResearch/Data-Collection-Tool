stages:
  - setup
  - startup
  - runtests

setup-job:
  stage: setup
  script:
    - echo "Setting environment up..."
    - cp back/proj_back/.env.sample back/proj_back/.env
    - cat back/proj_back/.env
  only:
    refs:
      - main
  when: manual

startup-job:
  stage: startup
  script:
    - echo "Starting docker test app..."
    - docker-compose docker-compose.test.yml build
    - docker-compose -f docker-compose.test.yml up -d
    - docker exec iss_test_back cat .env
  only:
    refs:
      - main
  when: manual

test-job:
  stage: runtests
  script: echo 'RUN TESTS'
  only:
    refs:
      - main
  when: manual